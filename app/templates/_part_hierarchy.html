
{# app/templates/_part_hierarchy.html (НОВЫЙ ФАЙЛ) #}

{% macro render_children(parts) %}
    <ul class="list-disc list-inside space-y-2">
        {% for part in parts %}
            <li>
                <a href="{{ url_for('main.history', part_id=part.part_id) }}" class="text-blue-600 hover:underline">{{ part.name }} ({{ part.part_id }})</a> - {{ part.quantity_total }} шт.
                {# Рекурсивный вызов для отображения "внуков" и т.д. #}
                {% if part.children.count() > 0 %}
                    <div class="ml-6 mt-1">
                        {{ render_children(part.children.order_by('name')) }}
                    </div>
                {% endif %}
            </li>
        {% endfor %}
    </ul>
{% endmacro %}